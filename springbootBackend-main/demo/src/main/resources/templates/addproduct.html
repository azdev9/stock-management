<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--========== BOX ICONS ==========-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">

    <!--========== CSS ==========-->
    <link rel="stylesheet" href="/css/product.css">
    <link rel="stylesheet" href="/css/style.css">

    <title>Add Product - StockApp</title>

    <style>
        /* Container for header and button */
        .product-management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        /* Style for comboboxes (select elements) */
        select {
            -webkit-appearance: none; /* For Chrome, Safari, Edge */
            -moz-appearance: none;    /* For Firefox */
            appearance: none;         /* Standard */
            background-color: var(--container-color);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 0.25rem;
            padding: 0.75rem 2.5rem 0.75rem 0.75rem; /* Increased right padding to 2.5rem to give space for the arrow */
            font-size: var(--small-font-size);
            font-family: var(--body-font);
            color: var(--text-color);
            cursor: pointer;
            width: 100%; /* Ensure consistent width */
            box-sizing: border-box; /* Prevent padding from affecting width */
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: calc(100% - 1rem) center; /* Position arrow 1rem from the right edge */
            background-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        select:hover {
            border-color: var(--first-color-light);
        }

        select:focus {
            border-color: var(--first-color);
            box-shadow: 0 0 5px rgba(46, 204, 113, 0.3);
            outline: none;
        }
    </style>
</head>
<body>
<!--========== HEADER ==========-->
<header class="header">
    <div class="header__container">
        <img src="/images/profile-img.png" alt="Profile" class="header__img">
        <a href="#" class="header__logo">StockApp</a>
        <div class="header__search">
            <input type="search" placeholder="Search by Product Name" class="header__input" id="searchInput">
            <i class='bx bx-search header__icon'></i>
        </div>
        <div class="header__toggle">
            <i class='bx bx-menu' id="header-toggle"></i>
        </div>
    </div>
</header>

<!--========== NAV ==========-->
<div th:replace="~{fragments/sidebar :: sidebar}"></div>

<!--========== CONTENTS ==========-->
<main>
    <section class="product-management">
        <div class="product-management-header">
            <h2>Add New Product</h2>
            <a href="/product" class="modal__button">Back to Products</a>
        </div>
        <div th:if="${errorMessage}" class="error">
            <p th:text="${errorMessage}"></p>
        </div>
        <form id="addProductForm" th:action="@{/product/add}" th:object="${product}" method="post" class="product-form">
            <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
            <div class="form-group">
                <label for="productName">Name</label>
                <input type="text" th:field="*{productName}" id="productName" placeholder="Product Name" required />
                <span th:if="${#fields.hasErrors('productName')}" th:errors="*{productName}" class="error"></span>
            </div>
            <div class="form-group">
                <label for="productCategory">Category</label>
                <select th:field="*{category.id}" id="productCategory" required>
                    <option value="">Select a category</option>
                    <option th:each="category : ${categories}"
                            th:value="${category.id}"
                            th:text="${category.name}"></option>
                </select>
                <span th:if="${#fields.hasErrors('category.id')}" th:errors="*{category.id}" class="error"></span>
            </div>
            <div class="form-group">
                <label for="productQuantity">Quantity</label>
                <input type="number" th:field="*{quantity}" id="productQuantity" placeholder="Quantity" required />
                <span th:if="${#fields.hasErrors('quantity')}" th:errors="*{quantity}" class="error"></span>
            </div>
            <div class="form-group">
                <label for="productSupplier">Supplier</label>
                <select th:field="*{supplier.id}" id="productSupplier">
                    <option value="">Select a supplier</option>
                    <option th:each="supplier : ${suppliers}"
                            th:value="${supplier.id}"
                            th:text="${supplier.name}"
                            th:disabled="${supplier.status == 'INACTIVE'}"></option>
                </select>
                <span th:if="${#fields.hasErrors('supplier.id')}" th:errors="*{supplier.id}" class="error"></span>
            </div>
            <div class="form-group">
                <label for="productPrice">Price</label>
                <input type="number" step="0.01" th:field="*{price}" id="productPrice" placeholder="Price" required />
                <span th:if="${#fields.hasErrors('price')}" th:errors="*{price}" class="error"></span>
            </div>
            <div class="form-group">
                <label for="productDate">Date</label>
                <input type="date" th:field="*{date}" id="productDate" required />
                <span th:if="${#fields.hasErrors('date')}" th:errors="*{date}" class="error"></span>
            </div>
            <div class="form-group">
                <label for="productImg">Image URL</label>
                <input type="url" th:field="*{image}" id="productImg" placeholder="Image URL" />
                <span th:if="${#fields.hasErrors('image')}" th:errors="*{image}" class="error"></span>
            </div>
            <div class="form-group">
                <button type="submit">Add Product</button>
            </div>
        </form>
    </section>
</main>

<!--========== FOOTER ==========-->
<footer class="footer">
    <p>Â© 2025 StockApp. All rights reserved.</p>
</footer>

<!--========== MAIN JS ==========-->
<script src="/js/main.js"></script>
<script>
    document.getElementById('searchInput').addEventListener('input', function() {
        // No search functionality needed for add product page, but keeping for consistency
    });

    document.addEventListener('DOMContentLoaded', function() {
        const dateInput = document.getElementById('productDate');
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const day = String(today.getDate()).padStart(2, '0');
        dateInput.value = `${year}-${month}-${day}`;
    });
</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93c98a222ac8bfa7',t:'MTc0NjcxMzQxNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>